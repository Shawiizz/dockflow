---
# Stack management role - main entry point
# This role handles stack lifecycle including listing and general management

- name: Set stacks directory path
  set_fact:
    stacks_dir: "{{ stack_dir }}"

- name: Ensure stack directory exists
  file:
    path: "{{ stacks_dir }}"
    state: directory
    mode: '0755'

- name: List current releases
  find:
    paths: "{{ stacks_dir }}"
    file_type: directory
    patterns: "[0-9]*"
  register: stack_releases

- name: Display stack status
  debug:
    msg: |
      Stack Management for: {{ stack_name }}
      - Total releases: {{ stack_releases.files | length }}
      - Current symlink: {{ stacks_dir }}/current
