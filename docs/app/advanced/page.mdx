# Advanced Usage

import { FileTree } from 'nextra/components'

## Custom Templates

Add custom configs in `.deployment/templates/`:

<FileTree>
  <FileTree.Folder name=".deployment" defaultOpen>
    <FileTree.Folder name="templates" defaultOpen>
      <FileTree.Folder name="nginx">
        <FileTree.File name="my-app.conf.j2" />
      </FileTree.Folder>
      <FileTree.Folder name="services">
        <FileTree.File name="my-service.service.j2" />
        <FileTree.File name="my-service.mount.j2" />
      </FileTree.Folder>
      <FileTree.Folder name="scripts">
        <FileTree.File name="pre-deploy.sh.j2" />
      </FileTree.Folder>
    </FileTree.Folder>
  </FileTree.Folder>
</FileTree>

All templates support **Jinja2 syntax** and have access to environment variables.

### Custom Nginx Configuration

**Example:** Create `.deployment/templates/nginx/my-app.conf.j2`

```nginx
server {
    listen 80;
    server_name {{ domain }};

    location / {
        proxy_pass http://localhost:{{ app_port }};
        proxy_set_header Host $host;
    }
}
```

### Custom Systemd Service

**Example:** Create `.deployment/templates/services/my-worker.service.j2`

```ini
[Unit]
Description={{ service_description }}
After=docker.service

[Service]
Type=simple
ExecStart={{ script_path }}
Environment="ENV={{ env }}"
Restart=always

[Install]
WantedBy=multi-user.target
```

### Post-Deployment Scripts

**Example:** Create `.deployment/templates/scripts/cleanup.sh.j2`

```bash
#!/bin/bash
echo "Starting cleanup for {{ env }}..."

# Clean old Docker images
docker image prune -af --filter "until=24h"

echo "Cleanup complete!"
```
